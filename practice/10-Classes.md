# Python 类（Classes）学习要点与练习

## 要点总结

1. **Python 中的一切皆对象**：
   - 每个对象都基于一个类
   - 每个对象都有方法和属性

2. **类的基本概念**：
   - 类是对象的蓝图
   - 类定义了对象的属性和方法
   - 类名通常首字母大写

3. **类的定义**：
   ```python
   # Python 3 语法
   class Vehicle:
       """类的文档字符串"""
       
       def __init__(self):
           """构造函数"""
           pass
   ```

4. **构造函数 `__init__`**：
   - 初始化对象时自动调用
   - 用于设置对象的初始属性
   - 只在创建对象时调用一次

5. **self 参数**：
   - 代表类的实例本身
   - 每个实例方法的第一个参数必须是 self
   - 通过 self 可以访问实例的属性和方法

6. **类的属性和方法**：
   - 属性：描述对象的特征（如颜色、大小等）
   - 方法：描述对象的行为（如驾驶、刹车等）

7. **实例化**：
   - 通过类名后跟括号创建类的实例
   - 例：`car = Vehicle("blue", 5, 4)`

8. **继承**：
   - 通过在类定义时在括号中指定父类来实现
   - 子类继承父类的所有属性和方法
   - 可以重写（覆盖）父类的方法

9. **多态性**：
   - Python 使用"鸭子类型"（duck typing）
   - 只要类有相同名称的方法，就可以以相同方式使用

10. **Python 3 与 Python 2 的区别**：
    - Python 3 中可以省略继承自 object：`class Vehicle:`
    - Python 2 中需要显式继承：`class Vehicle(object):`

## 练习题

### 练习 1：创建一个简单的类
**要求**：创建一个名为 `Book` 的类，包含 `title`、`author` 和 `pages` 三个属性，以及一个返回书籍信息的 `get_info` 方法。

**解题思路**：
1. 定义一个 `Book` 类
2. 在 `__init__` 方法中初始化三个属性
3. 创建 `get_info` 方法返回书籍信息字符串

**验收标准**：
- 类名为 `Book`，首字母大写
- `__init__` 方法接收 title, author, pages 三个参数并正确赋值给实例属性
- `get_info` 方法返回格式为 "《标题》由作者名著，共页数页" 的字符串
- 能够正确创建实例并调用方法获取信息

### 练习 2：属性访问与修改
**要求**：创建一个 `Person` 类，包含 `name` 和 `age` 属性，实现 `introduce` 方法和 `have_birthday` 方法（使年龄增加1）。

**解题思路**：
1. 定义 `Person` 类，初始化 name 和 age 属性
2. 创建 `introduce` 方法返回自我介绍
3. 创建 `have_birthday` 方法增加年龄

**验收标准**：
- 正确定义类和构造函数
- `introduce` 方法返回格式为 "我叫xxx，今年xx岁" 的字符串
- `have_birthday` 方法将 age 属性值加1
- 能够创建实例，调用方法，并验证属性被正确修改

### 练习 3：方法重载
**要求**：创建一个 `Calculator` 类，实现 `add` 方法，使其既能处理两个数字相加，也能处理列表中所有数字相加。

**解题思路**：
1. 定义 `Calculator` 类
2. 实现 `add` 方法，判断参数类型
3. 如果是两个数字，直接相加；如果是列表，计算总和

**验收标准**：
- `add` 方法能接受两个数字参数并返回它们的和
- `add` 方法能接受一个数字列表参数并返回列表所有元素的和
- 方法能正确处理不同类型的输入（整数、浮点数）
- 代码中包含适当的类型检查

### 练习 4：简单继承
**要求**：创建 `Animal` 基类和 `Dog` 子类。`Animal` 有 `name` 属性和 `speak` 方法，`Dog` 继承 `Animal` 并重写 `speak` 方法。

**解题思路**：
1. 创建 `Animal` 基类，包含 name 属性和返回通用声音的 speak 方法
2. 创建 `Dog` 子类继承 `Animal`，重写 speak 方法返回 "汪汪"

**验收标准**：
- `Animal` 类有 `name` 属性和返回 "..." 的 `speak` 方法
- `Dog` 类正确继承 `Animal` 类
- `Dog` 类重写 `speak` 方法返回 "汪汪"
- 能正确创建 `Dog` 实例并调用继承的和重写的方法

### 练习 5：多级继承
**要求**：创建 `Vehicle`、`Car` 和 `SportsCar` 三个类，形成继承链，每个类都有自己的特性和方法。

**解题思路**：
1. 创建基类 `Vehicle`，包含通用属性和方法
2. 创建 `Car` 类继承 `Vehicle`，添加汽车特有属性和方法
3. 创建 `SportsCar` 类继承 `Car`，添加跑车特有属性和方法

**验收标准**：
- 正确实现三级继承关系
- 每个类都有自己独特的属性和方法
- `SportsCar` 能访问所有三个类中定义的方法
- 能正确创建实例并调用各级继承的方法

### 练习 6：属性封装
**要求**：创建 `BankAccount` 类，使用私有属性 `__balance` 存储余额，提供 `deposit`、`withdraw` 和 `get_balance` 方法操作余额。

**解题思路**：
1. 创建 `BankAccount` 类，使用 `__balance` 作为私有属性
2. 实现存款、取款和查询余额的公共方法
3. 确保取款金额不能超过余额

**验收标准**：
- `__balance` 属性正确定义为私有属性
- `deposit` 方法能增加余额
- `withdraw` 方法在余额充足时减少余额，否则返回错误信息
- `get_balance` 方法返回当前余额
- 无法从类外部直接访问 `__balance` 属性

### 练习 7：类方法和静态方法
**要求**：创建 `MathHelper` 类，包含一个类方法 `from_string` 和一个静态方法 `is_prime`。

**解题思路**：
1. 创建 `MathHelper` 类
2. 使用 `@classmethod` 装饰器创建 `from_string` 方法，将字符串转换为数字
3. 使用 `@staticmethod` 装饰器创建 `is_prime` 方法，判断数字是否为质数

**验收标准**：
- 正确使用 `@classmethod` 和 `@staticmethod` 装饰器
- `from_string` 方法能将字符串 "123" 转换为整数 123
- `is_prime` 方法能正确判断一个数是否为质数
- 能不创建实例直接通过类名调用这两个方法

### 练习 8：特殊方法
**要求**：创建 `Vector` 类表示二维向量，实现 `__add__`、`__sub__` 和 `__str__` 特殊方法。

**解题思路**：
1. 创建 `Vector` 类，包含 x 和 y 坐标属性
2. 实现 `__add__` 方法实现向量加法
3. 实现 `__sub__` 方法实现向量减法
4. 实现 `__str__` 方法返回向量的字符串表示

**验收标准**：
- `Vector` 类有 x 和 y 属性表示坐标
- `__add__` 方法返回两个向量相加的新向量
- `__sub__` 方法返回两个向量相减的新向量
- `__str__` 方法返回格式为 "Vector(x, y)" 的字符串
- 能使用 `+` 和 `-` 运算符操作两个向量实例

### 练习 9：属性装饰器
**要求**：创建 `Temperature` 类，使用 `@property` 装饰器提供摄氏度和华氏度的转换。

**解题思路**：
1. 创建 `Temperature` 类，内部存储摄氏温度
2. 使用 `@property` 装饰器创建 `celsius` 和 `fahrenheit` 属性
3. 使用 `@celsius.setter` 和 `@fahrenheit.setter` 实现设置温度的功能

**验收标准**：
- 正确使用 `@property` 装饰器
- 能通过 `celsius` 属性获取和设置摄氏温度
- 能通过 `fahrenheit` 属性获取和设置华氏温度
- 修改一种温度时，另一种温度自动更新
- 转换公式正确：F = C * 9/5 + 32

### 练习 10：多重继承
**要求**：创建 `Flyable` 和 `Swimmable` 两个类，然后创建 `Duck` 类同时继承这两个类。

**解题思路**：
1. 创建 `Flyable` 类，包含 `fly` 方法
2. 创建 `Swimmable` 类，包含 `swim` 方法
3. 创建 `Duck` 类同时继承这两个类
4. 在 `Duck` 类中实现 `describe` 方法

**验收标准**：
- 正确实现多重继承
- `Duck` 类能调用 `fly` 和 `swim` 方法
- `describe` 方法返回描述鸭子会飞和游泳的字符串
- 能创建 `Duck` 实例并调用所有方法

### 练习 11：抽象基类
**要求**：使用 `abc` 模块创建一个抽象基类 `Shape`，要求子类必须实现 `area` 和 `perimeter` 方法。

**解题思路**：
1. 导入 `abc` 模块
2. 创建 `Shape` 抽象基类，使用 `@abstractmethod` 定义抽象方法
3. 创建 `Rectangle` 子类实现所有抽象方法

**验收标准**：
- 正确导入和使用 `abc` 模块
- `Shape` 类定义为抽象基类，包含 `area` 和 `perimeter` 抽象方法
- 尝试实例化 `Shape` 类会引发错误
- `Rectangle` 子类正确实现所有抽象方法
- 能创建 `Rectangle` 实例并调用方法

### 练习 12：类组合
**要求**：创建 `Engine` 和 `Car` 类，`Car` 类包含一个 `Engine` 实例作为属性。

**解题思路**：
1. 创建 `Engine` 类，包含启动和停止方法
2. 创建 `Car` 类，在构造函数中创建 `Engine` 实例
3. `Car` 类的方法通过调用其 `engine` 属性的方法来实现功能

**验收标准**：
- `Engine` 类有 `start` 和 `stop` 方法
- `Car` 类在初始化时创建 `Engine` 实例
- `Car` 类的 `start_car` 和 `stop_car` 方法调用 `engine` 的相应方法
- 能创建 `Car` 实例并正确调用方法

### 练习 13：工厂模式
**要求**：实现一个简单的工厂模式，创建 `ShapeFactory` 类，能根据参数创建不同的形状类实例。

**解题思路**：
1. 创建 `Circle` 和 `Rectangle` 类，都有 `draw` 方法
2. 创建 `ShapeFactory` 类，包含 `create_shape` 方法
3. 根据传入的形状名称返回相应的形状实例

**验收标准**：
- `Circle` 和 `Rectangle` 类都有 `draw` 方法
- `ShapeFactory` 类有 `create_shape` 静态方法
- 传入 "circle" 返回 `Circle` 实例，传入 "rectangle" 返回 `Rectangle` 实例
- 传入未知形状名称时返回错误信息
- 能通过工厂创建实例并调用方法

### 练习 14：单例模式
**要求**：实现单例模式，创建一个 `Logger` 类，确保只能创建一个实例。

**解题思路**：
1. 创建 `Logger` 类
2. 使用类变量存储唯一实例
3. 在 `__new__` 方法中检查实例是否已存在

**验收标准**：
- `Logger` 类正确实现单例模式
- 多次调用 `Logger()` 返回同一个实例
- 实例有 `log` 方法记录消息
- 能验证两个变量引用的是同一个实例

### 练习 15：类装饰器
**要求**：创建一个类装饰器 `@timer`，用于测量类方法的执行时间。

**解题思路**：
1. 导入 `time` 模块
2. 创建 `timer` 装饰器函数
3. 装饰器包装原方法，记录执行前后的时间差
4. 创建测试类使用该装饰器

**验收标准**：
- 正确实现 `timer` 装饰器函数
- 装饰器能测量并打印方法执行时间
- 被装饰的方法功能保持不变
- 能在测试类中正确使用装饰器

### 练习 16：自定义异常类
**要求**：创建自定义异常类 `InvalidAgeError`，并在 `Person` 类中使用它验证年龄。

**解题思路**：
1. 创建 `InvalidAgeError` 类继承 `Exception`
2. 创建 `Person` 类，在设置年龄时进行验证
3. 如果年龄无效，抛出自定义异常

**验收标准**：
- `InvalidAgeError` 类正确继承 `Exception`
- `Person` 类在设置无效年龄时抛出 `InvalidAgeError`
- 异常消息清晰说明错误原因
- 能捕获异常并处理

### 练习 17：枚举类
**要求**：使用 `enum` 模块创建 `Color` 枚举类，并在 `Shape` 类中使用它。

**解题思路**：
1. 导入 `enum` 模块
2. 创建 `Color` 枚举类定义几种颜色
3. 创建 `Shape` 类，使用 `Color` 枚举作为属性类型

**验收标准**：
- 正确导入和使用 `enum` 模块
- `Color` 枚举包含至少三种颜色
- `Shape` 类的 `color` 属性只接受 `Color` 枚举值
- 能创建 `Shape` 实例并设置/获取颜色

### 练习 18：元类
**要求**：创建一个元类 `SingletonMeta`，使用它创建的类都是单例类。

**解题思路**：
1. 创建 `SingletonMeta` 类继承 `type`
2. 重写 `__call__` 方法实现单例逻辑
3. 创建使用该元类的测试类

**验收标准**：
- 正确创建 `SingletonMeta` 元类
- 使用该元类的类都是单例类
- 多次实例化测试类返回同一个实例
- 不同的使用该元类的类有各自的单例

### 练习 19：描述符
**要求**：创建一个描述符类 `Range`，用于限制属性值在指定范围内。

**解题思路**：
1. 创建 `Range` 描述符类，实现 `__get__`、`__set__` 方法
2. 在 `__set__` 方法中验证值是否在范围内
3. 创建测试类使用该描述符

**验收标准**：
- `Range` 类正确实现描述符协议
- 描述符能限制属性值在指定范围内
- 设置超出范围的值时抛出异常
- 能在测试类中正确使用描述符

### 练习 20：上下文管理器
**要求**：创建一个 `File` 类，实现上下文管理器协议，用于安全地打开和关闭文件。

**解题思路**：
1. 创建 `File` 类，接收文件名和模式参数
2. 实现 `__enter__` 和 `__exit__` 方法
3. 在 `__enter__` 中打开文件，在 `__exit__` 中关闭文件

**验收标准**：
- `File` 类正确实现 `__enter__` 和 `__exit__` 方法
- 能使用 `with` 语句安全地操作文件
- 即使发生异常，文件也能正确关闭
- 能读取和写入文件内容
